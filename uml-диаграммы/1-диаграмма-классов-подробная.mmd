classDiagram
    class Пользователь {
        -число идентификатор
        -строка электроннаяПочта
        -строка пароль
        -строка полноеИмя
        -СущностьФайла[] файлы
        +войти(почта: строка, пароль: строка) Обещание~объект~
        +зарегистрироваться(данные: объект) Обещание~объект~
        +выйти() пусто
        +получитьПрофиль() Обещание~Пользователь~
    }

    class СущностьФайла {
        -число идентификатор
        -строка имяФайла
        -строка оригинальноеИмя
        -число размер
        -строка типMIME
        -число идентификаторПользователя
        -Дата датаСоздания
        -Дата датаУдаления
        -логический вИзбранном
        -СущностьПользователя пользователь
        +загрузить(файл: объект) Обещание~СущностьФайла~
        +скачать() Обещание~объект~
        +удалить() Обещание~пусто~
        +восстановить() Обещание~объект~
        +переключитьИзбранное() Обещание~СущностьФайла~
    }

    class ТипФайла {
        <<перечисление>>
        ФОТОГРАФИИ
        КОРЗИНА
        ИЗБРАННОЕ
        ВСЕ
    }

    class СервисПользователей {
        -Репозиторий~Пользователь~ репозиторий
        +найтиПоПочте(почта: строка) Обещание~Пользователь~
        +найтиПоИдентификатору(идентификатор: строка) Обещание~Пользователь~
        +создать(данные: объект) Обещание~Пользователь~
    }

    class СервисФайлов {
        -Репозиторий~СущностьФайла~ репозиторий
        +найтиВсе(идентификаторПользователя: число, типФайла?: ТипФайла) Обещание~СущностьФайла[]~
        +создать(файл: объект, идентификаторПользователя: строка) Обещание~СущностьФайла~
        +удалить(идентификаторПользователя: строка, идентификаторы: строка) Обещание~пусто~
        +восстановить(идентификаторПользователя: строка, идентификаторы: строка) Обещание~объект~
        +переключитьИзбранное(идентификаторПользователя: число, идентификаторФайла: число) Обещание~СущностьФайла~
        +получитьИзбранные(идентификаторПользователя: число) Обещание~СущностьФайла[]~
    }

    class СервисАутентификации {
        -СервисПользователей сервисПользователей
        -СервисJWT сервисJWT
        +проверитьПользователя(почта: строка, пароль: строка) Обещание~объект~
        +зарегистрировать(данные: объект) Обещание~объект~
        +войти(пользователь: Пользователь) Обещание~объект~
    }

    class КонтроллерПользователей {
        -СервисПользователей сервисПользователей
        +получитьПрофиль(идентификатор: строка) Обещание~Пользователь~
    }

    class КонтроллерФайлов {
        -СервисФайлов сервисФайлов
        +получитьВсе(идентификаторПользователя: число, типФайла?: ТипФайла) Обещание~СущностьФайла[]~
        +загрузить(файл: объект, идентификаторПользователя: строка) Обещание~СущностьФайла~
        +удалить(идентификаторПользователя: строка, идентификаторы: строка) Обещание~пусто~
        +восстановить(идентификаторПользователя: строка, идентификаторы: строка) Обещание~объект~
        +переключитьИзбранное(идентификаторПользователя: число, идентификаторФайла: число) Обещание~СущностьФайла~
        +получитьИзбранные(идентификаторПользователя: число) Обещание~СущностьФайла[]~
    }

    class КонтроллерАутентификации {
        -СервисАутентификации сервисАутентификации
        +войти(данные: объект) Обещание~объект~
        +зарегистрировать(данные: объект) Обещание~объект~
    }

    %% Связи между сущностями
    Пользователь "1" *-- "*" СущностьФайла : владеет
    СущностьФайла "*" --> "1" Пользователь : принадлежит

    %% Связи сервисов с сущностями
    СервисПользователей "1" ..> "*" Пользователь : работает с
    СервисФайлов "1" ..> "*" СущностьФайла : работает с
    СервисФайлов "1" ..> "1" ТипФайла : использует
    СервисАутентификации "1" ..> "*" Пользователь : работает с
    СервисАутентификации "1" --> "1" СервисПользователей : использует

    %% Связи контроллеров с сервисами
    КонтроллерПользователей "1" --> "1" СервисПользователей : использует
    КонтроллерФайлов "1" --> "1" СервисФайлов : использует
    КонтроллерАутентификации "1" --> "1" СервисАутентификации : использует

    %% Связи контроллеров с сущностями
    КонтроллерПользователей "1" ..> "*" Пользователь : возвращает
    КонтроллерФайлов "1" ..> "*" СущностьФайла : возвращает
    КонтроллерАутентификации "1" ..> "*" Пользователь : обрабатывает
